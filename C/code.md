Here is the C code
